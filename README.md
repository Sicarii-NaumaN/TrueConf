P.S. Хотел по файлам разбросать, но, думаю для проверяющего так будет удобнее.
Не знаю, настолько ли принципиально использование именно map, если потребуется - переделаю.
